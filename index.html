<!DOCTYPE html>
<html lang="lt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tautiniai kostiumai ‚Äì Balsavimas</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Source+Sans+3:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #f5f0e8;
            --card-bg: #ffffff;
            --accent: #8b4513;
            --accent-light: #c4956a;
            --accent-dark: #5c2d0e;
            --text: #2c1810;
            --text-muted: #6b5242;
            --border: #d4c4b0;
            --selected: #fdf6ee;
            --selected-border: #c4956a;
            --section-bg: #ebe3d6;
            --green: #4a7c59;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Source Sans 3', sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; }

        .header {
            background: linear-gradient(135deg, var(--accent-dark) 0%, var(--accent) 50%, var(--accent-light) 100%);
            color: white; padding: 2.5rem 1.5rem; text-align: center; position: relative; overflow: hidden;
        }
        .header::before {
            content: ''; position: absolute; inset: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30 0L60 30L30 60L0 30Z' fill='none' stroke='rgba(255,255,255,0.06)' stroke-width='1'/%3E%3C/svg%3E");
            pointer-events: none;
        }
        .header h1 { font-family: 'Playfair Display', serif; font-size: clamp(1.8rem, 4vw, 2.8rem); font-weight: 700; margin-bottom: 0.5rem; position: relative; }
        .header p { font-size: 1.05rem; font-weight: 300; opacity: 0.9; position: relative; max-width: 600px; margin: 0 auto; }

        .vote-bar {
            position: sticky; top: 0; z-index: 100; background: rgba(255,255,255,0.95); backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border); padding: 0.75rem 1.5rem;
            display: flex; align-items: center; justify-content: space-between; gap: 1rem;
            box-shadow: 0 1px 4px rgba(0,0,0,0.05); transition: box-shadow 0.3s;
        }
        .vote-bar.scrolled { box-shadow: 0 2px 12px rgba(0,0,0,0.1); }
        .vote-count { font-weight: 600; font-size: 0.95rem; color: var(--accent-dark); }
        .vote-count span {
            display: inline-block; background: var(--accent); color: white; border-radius: 50%;
            width: 28px; height: 28px; line-height: 28px; text-align: center; font-size: 0.85rem;
            margin-right: 0.4rem; transition: transform 0.2s;
        }
        .btn-submit {
            background: var(--green); color: white; border: none; padding: 0.6rem 1.5rem; border-radius: 8px;
            font-family: 'Source Sans 3', sans-serif; font-size: 0.95rem; font-weight: 600; cursor: pointer;
            transition: all 0.2s; white-space: nowrap;
        }
        .btn-submit:hover { background: #3d6a4b; transform: translateY(-1px); }
        .btn-submit:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .btn-clear {
            background: none; border: 1px solid var(--border); color: var(--text-muted);
            padding: 0.5rem 1rem; border-radius: 8px; font-family: 'Source Sans 3', sans-serif;
            font-size: 0.85rem; cursor: pointer; transition: all 0.2s; white-space: nowrap;
        }
        .btn-clear:hover { border-color: var(--accent); color: var(--accent); }

        .container { max-width: 1200px; margin: 0 auto; padding: 1.5rem; }

        .region-section { margin-bottom: 2.5rem; }
        .region-header {
            font-family: 'Playfair Display', serif; font-size: 1.6rem; font-weight: 600; color: var(--accent-dark);
            padding: 1rem 1.25rem; background: var(--section-bg); border-left: 4px solid var(--accent);
            border-radius: 0 8px 8px 0; margin-bottom: 1.25rem;
        }

        .costume-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 1rem; }

        .costume-card {
            background: var(--card-bg); border: 2px solid var(--border); border-radius: 12px;
            overflow: hidden; cursor: pointer; transition: all 0.25s ease; position: relative;
        }
        .costume-card:hover { border-color: var(--accent-light); transform: translateY(-3px); box-shadow: 0 8px 24px rgba(139,69,19,0.12); }
        .costume-card.selected { border-color: var(--selected-border); background: var(--selected); box-shadow: 0 4px 16px rgba(139,69,19,0.15); }
        .costume-card.selected .card-check { background: var(--green); border-color: var(--green); }
        .costume-card.selected .card-check svg { opacity: 1; transform: scale(1); }

        .card-image-wrap { position: relative; aspect-ratio: 3/4; background: var(--section-bg); overflow: hidden; }
        .card-image-wrap img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.4s; }
        .costume-card:hover .card-image-wrap img { transform: scale(1.05); }

        .card-check {
            position: absolute; top: 10px; right: 10px; width: 30px; height: 30px; border-radius: 8px;
            border: 2px solid rgba(255,255,255,0.7); background: rgba(255,255,255,0.6); backdrop-filter: blur(4px);
            display: flex; align-items: center; justify-content: center; transition: all 0.2s; z-index: 2;
        }
        .card-check svg { width: 16px; height: 16px; opacity: 0; transform: scale(0.5); transition: all 0.2s; }

        .card-info { padding: 0.75rem 1rem; }
        .card-number { font-size: 0.75rem; font-weight: 600; color: var(--accent-light); text-transform: uppercase; letter-spacing: 0.08em; }
        .card-title { font-family: 'Playfair Display', serif; font-size: 0.95rem; font-weight: 500; color: var(--text); margin-top: 0.15rem; }

        .costume-card input[type="checkbox"] { position: absolute; opacity: 0; width: 0; height: 0; }

        .img-placeholder {
            width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;
            background: linear-gradient(135deg, var(--section-bg), #d4c4b0);
            color: var(--text-muted); font-size: 0.8rem; text-align: center; padding: 1rem;
        }

        .toast {
            position: fixed; bottom: 2rem; left: 50%; transform: translateX(-50%) translateY(100px);
            padding: 1rem 2rem; border-radius: 12px; font-weight: 600; font-size: 0.95rem;
            z-index: 300; opacity: 0; transition: all 0.4s ease; pointer-events: none;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
        }
        .toast.success { background: var(--green); color: white; }
        .toast.error { background: #c0392b; color: white; }
        .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

        .voted-banner {
            background: var(--green); color: white; text-align: center; padding: 0.8rem 1.5rem;
            font-weight: 500; display: none;
        }
        .voted-banner.show { display: block; }

        @media (max-width: 600px) {
            .costume-grid { grid-template-columns: repeat(2, 1fr); gap: 0.75rem; }
            .card-info { padding: 0.5rem 0.7rem; }
            .card-title { font-size: 0.85rem; }
            .vote-bar { padding: 0.6rem 1rem; font-size: 0.85rem; }
        }
    </style>
</head>
<body>

<div class="header">
    <h1>üá±üáπ Tautini≈≥ kostium≈≥ galerija</h1>
    <p>Pasirinkite patinkanƒçius kostiumus pa≈æymƒódami varnelƒô. Galima rinktis kelis variantus.</p>
</div>

<div class="voted-banner" id="votedBanner">
    ‚úì J≈´s jau balsavote! Aƒçi≈´ u≈æ dalyvavimƒÖ.
</div>

<div class="vote-bar" id="voteBar">
    <div class="vote-count">Pasirinkta: <span id="voteCountNum">0</span></div>
    <div style="display:flex;gap:0.5rem;align-items:center;">
        <button class="btn-clear" onclick="clearAll()">I≈°valyti</button>
        <button class="btn-submit" id="btnSubmit" onclick="submitVotes()" disabled>Pateikti balsƒÖ</button>
    </div>
</div>

<div class="container" id="gallery"></div>

<!-- Toast -->
<div class="toast" id="toast"></div>

<script>
// ============================================================
// ‚öôÔ∏è CONFIGURATION
// ============================================================

// Paste your Google Apps Script Web App URL here:
const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzRuwbj1nGe9CbdwladhDwWuOL0HUC47DPP6f01qyAJVsyLrDWvw_0NLDmmhfGLupvP/exec';

// Allow only one vote per browser:
const ONE_VOTE_PER_BROWSER = true;

// ============================================================
// COSTUME DATA ‚Äî add your image URLs in the "img" fields
// ============================================================
const regions = [
    {
        name: "Auk≈°taitija",
        items: [
            { id: "a1",  num: 1,  title: "Tautiniai kostiumai",  img: "img/DSC_0348.jpg" },
        { id: "a2",  num: 2,  title: "Tautiniai kostiumai", img: "img/DSC_0387.jpg" },
            { id: "a3",  num: 3,  title: "Tautiniai kostiumai", img: "img/DSC_0385.jpg" },
            { id: "a4",  num: 4,  title: "Tautiniai kostiumai", img: "img/DSC_05671.jpg" },
            { id: "a5",  num: 5,  title: "Tautiniai kostiumai", img: "img/DSC_0380.jpg" },
            { id: "a6",  num: 6,  title: "Tautiniai kostiumai", img: "img/DSC_0378.jpg" },
            { id: "a7",  num: 7,  title: "Tautiniai drabu≈æiai", img: "img/DSC_0372.jpg" },
            { id: "a8",  num: 8,  title: "Tautiniai drabu≈æiai", img: "img/DSC_0370.jpg" },
            { id: "a9",  num: 9,  title: "Tautiniai drabu≈æiai", img: "img/DSC_0353.jpg" },
            { id: "a10", num: 10, title: "Tautiniai drabu≈æiai", img: "img/DSC_0357.jpg" },
            { id: "a11", num: 11, title: "Tautiniai drabu≈æiai", img: "img/DSC_0420.jpg" },           
            { id: "a12", num: 12, title: "Tautiniai drabu≈æiai", img: "img/DSC_0362.jpg" },
            { id: "a13", num: 13, title: "Tautiniai drabu≈æiai", img: "img/DSC_0368.jpg" },
            { id: "a14", num: 14, title: "Tautiniai drabu≈æiai", img: "img/DSC_0374.jpg" },
            { id: "a15", num: 15, title: "Tautiniai drabu≈æiai", img: "img/DSC_0416.jpg" },
            { id: "a16", num: 16, title: "Tautiniai drabu≈æiai", img: "img/DSC_0418.jpg" },
            { id: "a17", num: 17, title: "Tautiniai drabu≈æiai", img: "img/DSC_0366.jpg" },
            { id: "a18", num: 18, title: "Tautiniai drabu≈æiai", img: "img/DSC_0565.jpg" },
            { id: "a19", num: 19, title: "Tautinis kostiumas",  img: "img/DSC_0586.jpg" },
            { id: "a20", num: 20, title: "Tautiniai kostiumai", img: "img/DSC_0593.jpg" },
            { id: "a21", num: 21, title: "Tautinis kostiumas",  img: "img/DSC_05721.jpg" },
        ]
    },
    {
        name: "≈Ωemaitija",
        items: [
            { id: "z1",  num: 1,  title: "Tautiniai drabu≈æiai", img: "img/zemaitija/DSC_0576.JPG" },
            { id: "z2",  num: 2,  title: "Tautiniai kostiumai", img: "img/zemaitija/DSC_0338.JPG" },
            { id: "z3",  num: 3,  title: "Tautiniai kostiumai", img: "img/zemaitija/DSC_0342.JPG" },
            { id: "z4",  num: 4,  title: "Tautiniai kostiumai", img: "img/zemaitija/DSC_0345.JPG" },
            { id: "z5",  num: 5,  title: "Tautiniai kostiumai", img: "img/zemaitija/DSC_0348.JPG" },
            { id: "z6",  num: 6,  title: "Tautiniai drabu≈æiai", img: "img/zemaitija/DSC_0350.JPG" },
            { id: "z7",  num: 7,  title: "Tautiniai drabu≈æiai", img: "img/zemaitija/DSC_0354.JPG" },
            { id: "z8",  num: 8,  title: "Tautiniai drabu≈æiai", img: "img/zemaitija/DSC_0358.JPG" },
            { id: "z9",  num: 9,  title: "Tautiniai drabu≈æiai", img: "img/zemaitija/DSC_0360.JPG" },
            { id: "z10", num: 10, title: "Tautiniai drabu≈æiai", img: "img/zemaitija/DSC_0362.JPG" },
            { id: "z11", num: 11, title: "Tautiniai drabu≈æiai", img: "img/zemaitija/DSC_0364.JPG" },
            { id: "z12", num: 12, title: "Tautiniai drabu≈æiai", img: "img/zemaitija/DSC_0366.JPG" },
            { id: "z13", num: 13, title: "Tautiniai drabu≈æiai", img: "img/zemaitija/DSC_0369.JPG" },
        ]
    },
    {
        name: "Dz≈´kija",
        items: [
            { id: "d1",  num: 1,  title: "Tautiniai kostiumai", img: "img/dzukija/DSC_0023.JPG" },
            { id: "d2",  num: 2,  title: "Tautiniai kostiumai", img: "img/dzukija/DSC_0025.JPG" },
            { id: "d3",  num: 3,  title: "Tautiniai kostiumai", img: "img/dzukija/DSC_0033.JPG" },
            { id: "d4",  num: 4,  title: "Tautiniai kostiumai", img: "img/dzukija/DSC_0034.JPG" },
            { id: "d5",  num: 5,  title: "Tautiniai kostiumai", img: "img/dzukija/DSC_0035.JPG" },
            { id: "d6",  num: 6,  title: "Tautiniai kostiumai", img: "img/dzukija/DSC_0036.JPG" },
            { id: "d7",  num: 7,  title: "Tautiniai kostiumai", img: "img/dzukija/DSC_0037.JPG" },
        ]
    },
    {
        name: "Klaipƒódos kra≈°tas",
        items: [
            { id: "k1", num: 1, title: "Tautinis kostiumas", img: "img/klaipeda/DSC_0038.JPG" },
            { id: "k2", num: 2, title: "Tautiniai kostiumai", img: "img/klaipeda/DSC_0039.JPG" },
            { id: "k3", num: 3, title: "Tautiniai kostiumai", img: "img/klaipeda/DSC_0031.JPG" },
            { id: "k4", num: 4, title: "Tautiniai kostiumai", img: "img/klaipeda/DSC_0032.JPG" },
        ]
    },
    {
        name: "Suvalkija",
        items: [
            { id: "s1", num: 1, title: "Tautinis kostiumas", img: "img/suvalkija/DSC_0133.JPG" },
            { id: "s2", num: 2, title: "Tautiniai kostiumai", img: "img/suvalkija/DSC_0135.JPG" },
            { id: "s3", num: 3, title: "Tautiniai kostiumai", img: "img/suvalkija/DSC_0136.JPG" },
            { id: "s4", num: 4, title: "Tautiniai kostiumai", img: "img/suvalkija/DSC_0130.JPG" },
            { id: "s5", num: 5, title: "Tautiniai kostiumai", img: "img/suvalkija/DSC_0131.JPG" },
        ]
    },
];

// ============================================================
// Build gallery
// ============================================================
const gallery = document.getElementById('gallery');
const checkSvg = `<svg viewBox="0 0 16 16"><path d="M13.5 4.5l-7 7L3 8" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/></svg>`;

regions.forEach(region => {
    const section = document.createElement('div');
    section.className = 'region-section';
    section.innerHTML = `<div class="region-header">${region.name}</div>`;
    const grid = document.createElement('div');
    grid.className = 'costume-grid';

    region.items.forEach(item => {
        const label = `${region.name} Nr. ${item.num}`;
        const card = document.createElement('label');
        card.className = 'costume-card';
        card.setAttribute('data-label', label);
        card.innerHTML = `
            <input type="checkbox" name="costume" value="${item.id}" onchange="updateVotes()">
            <div class="card-image-wrap">
                <img src="${item.img}" alt="${label}" loading="lazy"
                     onerror="this.parentElement.innerHTML='<div class=img-placeholder>üì∑<br>${label}</div>'">
                <div class="card-check">${checkSvg}</div>
            </div>
            <div class="card-info">
                <div class="card-number">${region.name} ¬∑ Nr. ${item.num}</div>
                <div class="card-title">${item.title}</div>
            </div>`;
        grid.appendChild(card);
    });

    section.appendChild(grid);
    gallery.appendChild(section);
});

// ============================================================
// Check if already voted
// ============================================================
if (ONE_VOTE_PER_BROWSER && localStorage.getItem('costume_voted')) {
    document.getElementById('votedBanner').classList.add('show');
    document.getElementById('btnSubmit').disabled = true;
    document.getElementById('btnSubmit').textContent = 'Jau balsavote';
}

// ============================================================
// Voting logic
// ============================================================
function getChecked() { return document.querySelectorAll('input[name="costume"]:checked'); }

function updateVotes() {
    const count = getChecked().length;
    document.getElementById('voteCountNum').textContent = count;
    const alreadyVoted = ONE_VOTE_PER_BROWSER && localStorage.getItem('costume_voted');
    document.getElementById('btnSubmit').disabled = count === 0 || alreadyVoted;
    document.querySelectorAll('.costume-card').forEach(card => {
        card.classList.toggle('selected', card.querySelector('input').checked);
    });
    const n = document.getElementById('voteCountNum');
    n.style.transform = 'scale(1.3)';
    setTimeout(() => n.style.transform = 'scale(1)', 200);
}

function clearAll() {
    document.querySelectorAll('input[name="costume"]').forEach(cb => cb.checked = false);
    updateVotes();
}

function showToast(message, type) {
    const toast = document.getElementById('toast');
    toast.textContent = message;
    toast.className = `toast ${type} show`;
    setTimeout(() => toast.classList.remove('show'), 4000);
}

function submitVotes() {
    const checked = getChecked();
    if (!checked.length) return;

    const btn = document.getElementById('btnSubmit');
    btn.textContent = 'Siunƒçiama...';
    btn.disabled = true;

    // Collect data
    const selectedIds = Array.from(checked).map(cb => cb.value);
    const selectedLabels = Array.from(checked).map(cb =>
        cb.closest('.costume-card').getAttribute('data-label')
    );

    // Send as form-urlencoded via fetch (no CORS issues with this format)
    const params = new URLSearchParams();
    params.append('timestamp', new Date().toISOString());
    params.append('votes', selectedIds.join(', '));
    params.append('labels', selectedLabels.join(', '));
    params.append('count', selectedIds.length.toString());

    fetch(GOOGLE_SCRIPT_URL, {
        method: 'POST',
        mode: 'no-cors',
        body: params
    }).then(() => {
        if (ONE_VOTE_PER_BROWSER) {
            localStorage.setItem('costume_voted', Date.now());
            document.getElementById('votedBanner').classList.add('show');
            btn.textContent = 'Jau balsavote';
            btn.disabled = true;
        } else {
            btn.textContent = 'Pateikti balsƒÖ';
            btn.disabled = false;
        }
        showToast('‚úì Aƒçi≈´! J≈´s≈≥ balsas priimtas.', 'success');
        clearAll();
    }).catch(() => {
        showToast('‚úó Klaida. Bandykite dar kartƒÖ.', 'error');
        btn.textContent = 'Pateikti balsƒÖ';
        btn.disabled = false;
    });
}

// Scroll effect
window.addEventListener('scroll', () => {
    document.getElementById('voteBar').classList.toggle('scrolled', window.scrollY > 100);
});
</script>
</body>
</html>
